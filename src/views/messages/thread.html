{% extends "base.html" %}

{% block title %}Conversation with {{ other_user.name }}{% endblock %}

{% block content %}
<div class="container mt-4 mb-5">
    <h1 class="mb-4"><i class="bi bi-chat"></i> Conversation with {{ other_user.name }}</h1>
    
    <!-- Messages -->
    <div class="card mb-4">
        <div class="card-body" style="max-height: 500px; overflow-y: auto;">
            {% for message in messages %}
            <div class="mb-3 {% if message.sender_id == current_user.user_id %}text-end{% endif %}">
                <div class="d-inline-block text-start" style="max-width: 70%;">
                    <div class="card {% if message.sender_id == current_user.user_id %}bg-primary text-white{% else %}bg-light{% endif %}">
                        <div class="card-body py-2 px-3">
                            <small class="d-block mb-1"><strong>{{ message.sender_name }}</strong></small>
                            <p class="mb-1">{{ message.content }}</p>
                            <small class="text-muted" style="font-size: 0.75rem;">{{ message.timestamp }}</small>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- Reply Form -->
    <div class="card">
        <div class="card-body">
            <form method="POST" action="{{ url_for('messages.send_message') }}">
                {{ form.hidden_tag() }}
                {{ form.receiver_id }}
                <div class="mb-3">
                    {{ form.content(class="form-control", rows="3", placeholder="Type your message...") }}
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-send"></i> Send Message
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

